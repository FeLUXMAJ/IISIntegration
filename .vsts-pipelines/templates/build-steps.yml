phases:
- template: .vsts-pipelines/templates/phases/default-build.yml@buildtools
  parameters:
    agentOs: Windows
    beforeBuild:
      - powershell: "git submodule update --init"
        displayName: Update submodules
      - powershell: "& ./tools/update_schema.ps1"
        displayName: Update ANCM schema
      - powershell: Restart-Service w3svc
        displayName: Restart IIS

- template: .vsts-pipelines/templates/phases/default-build.yml@buildtools
  parameters:
    agentOs: macOS

- template: .vsts-pipelines/templates/phases/default-build.yml@buildtools
  parameters:
    agentOs: Linux
